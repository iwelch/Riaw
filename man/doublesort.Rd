% Generated by tools/generate-man.R -- do not edit by hand
\name{doublesort}
\alias{doublesort}
\title{Double Sort for Portfolio Formation}
\description{
Given two criteria, sort by criterion 1 into groups, then rank within
each group by criterion 2. Middle observations removed if N not divisible.
}
\usage{
doublesort(crit.holdconstant, crit.spread, NUMPERGROUP)
}
\arguments{
  \item{crit.holdconstant}{First sort criterion (forms groups).}
  \item{crit.spread}{Second sort criterion (ranks within groups).}
  \item{NUMPERGROUP}{Observations per group. Default 5. }
}
\value{
Vector of within-group ranks (1 to NUMPERGROUP), NA for excluded obs. 
}
\seealso{

Other data-manipulation: \code{\link{diffid.for.fixed.effects}}, \code{\link{kill.useless.cols}}, \code{\link{recode}}, \code{\link{rename.columns}}, \code{\link{subset.data.frame}}
}
\examples{
\dontrun{
# Simple case: 9 stocks, 3 per group, size then value double-sort
size  <- c(1, 2, 3, 4, 5, 6, 7, 8, 9)
value <- c(9, 3, 7, 1, 5, 8, 2, 6, 4)
iaw$doublesort(size, value, NUMPERGROUP = 3)

# Larger example with excluded middle observations (N not divisible)
crit1 <- c(4, 9, 13, 11, 5, 7, 10, 1, 12, 8, 3, 6, 2)
crit2 <- c(-1, 10, 104, 103, 22, -99, 102, 1, 105, 11, 2, 33, -2)
iaw$doublesort(crit1, crit2, NUMPERGROUP = 4)  # NA = excluded middle obs

# Fama-French style: sort by market cap, then by book-to-market
mktcap <- c(100, 500, 200, 800, 50, 300, 700, 150, 400, 600)
bm     <- c(0.8, 0.3, 1.2, 0.1, 1.5, 0.6, 0.2, 0.9, 0.4, 0.7)
iaw$doublesort(mktcap, bm, NUMPERGROUP = 5)

# Even split: 8 obs, 4 per group, no exclusions
iaw$doublesort(1:8, 8:1, NUMPERGROUP = 4)

# Minimum NUMPERGROUP is 2
iaw$doublesort(c(5, 3, 1, 4, 2), c(1, 2, 3, 4, 5), NUMPERGROUP = 2)
}
}
