
# Riaw


# Documenting Functions

Documented functions usually sit in their own files.  Unlike oxygen2, we can first write the function and then the basic documentation, and we can use the naming feature of R to designate the standard fields.

myfunction.R:

	myfunction <- function( anyargument ) { print( anyargument ) }

	c(
	  author='ivo.welch@gmail.com',
	  description='an illustration',
	  usage='myfunction( anyargument )',
	  arguments='anyargument: anything',
	  details='this is for illustration',
	  seealso='print',
	  examples='
	    myfunction( "hello" )
	    myfunction( 12 ) ',
	  test= '',
	  changes= '',
	  version= '',
	)


source.docfn reads such a file, stores the last value as documentation and determines what functions were defined (added to the environment).  it executes something like

	  source.docfn <- function( filename, strict =0 ) {
	     old.environment <- .GlobalEnv
	     documentation <- source(filename)
	     new.function <- new.function(old.environment)
	     (length(new.function) == 1) %or% 
	        "source.docfn expected one new function in {{filename}}, not {{length(new.function)}} functions."
	    .GlobalEnv[[new.function]] <- cmpfun(.GlobalEnv[[new.function]])
	     for (docfield in names(documentation))
	        attr(new.function, docfield) <- documentation[[docfield]]
	     attr(new.function, "sourcefile") <- filename)
             if (strict) check( new.function ) ## make sure all required fields are there
	     invisible(new.function)
	  }

this has a number of advantages.  logically, everything that belongs to the function is now stored together.  the contents of the file and the Rd source can be easily parsed.  the example() function can be extended to read this from the function itself.


an author who prefers to have the docs at the start of the file can do so simply by saving the docs to tmp and ending his source file with tmp.  the contents of individual fields, such as description should be markdown.

	tmp <- c(
	  author='ivo.welch@gmail.com',
	  description='an illustration',
	  usage='myfunction( anyargument )',
	  arguments='anyargument: anything',
	  details='this is for illustration',
	  seealso='print',
	  examples='
	    myfunction( "hello" )
	    myfunction( 12 ) ',
	  test= '',
	  changes= '',
	  version= '',
	)
	################################################################
	myfunction <- function( anyargument ) { print( anyargument ) }

	tmp
